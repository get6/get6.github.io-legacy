{"componentChunkName":"component---src-templates-blog-post-tsx","path":"/others/2020/google-pay-api-guide/","result":{"data":{"site":{"siteMetadata":{"title":"Jun Wick's Blog","author":{"name":"Sung Jun, Hwang"}}},"markdownRemark":{"id":"96f2ecc2-c24c-5ba4-8f27-7b029fd691b0","excerpt":"Google Pay API를 해보는 과정을 정리해보려고 합니다. Google Pay API를 테스트하기전에 nodeJS express를 통해 웹서버를 만들어야 합니다. 링크 Google Pay API…","html":"<p>Google Pay API를 해보는 과정을 정리해보려고 합니다.</p>\n<p>Google Pay API를 테스트하기전에 nodeJS express를 통해 웹서버를 만들어야 합니다. <a href=\"/2020-03-13-nodejs-express-guide.markdown\">링크</a></p>\n<p><a href=\"https://developers.google.com/pay/api/web/guides/setup\">Google Pay API 설정</a>에서 결제 수단을 링크를 눌러 카드를 등록합니다.</p>\n<p>로그인 한 계정에 신용카드 또는 체크카드를 추가하면 결제 수단 등록이 완료됩니다.</p>\n<p>이제 왼쪽 네비게이션 가이드 - 가이드 메뉴를 누릅니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 590px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/194acd0d320e974a099eccbb85fa554d/4d4a2/google-pay-selected-guide.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 95.27027027027027%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAATCAYAAACQjC21AAAACXBIWXMAABYlAAAWJQFJUiTwAAACk0lEQVQ4y51SXW8MYRSe3yBKtRWVXqDBDRp61UYIeiFxx3/QT1QoEi3im4gL/oV/UB/hQiIirO7a0f3szvfMzlTXzr4zj3Nmditbm3TrTZ6c95zzzHPmvOdIOy4pOP7QwKknBkYIZ19YOPrAwJnnJobvx/Ghe3pkOXaMuKefmRh5auLkYwO7r6rYM6Pi3EsLB25qkLqmlCi477qKgTkNR27p2DmtoP9aHNtFOc73UuzQrBb5eynePxPbXvqh7RcV7L+hoe+ywoIlbJssoWM8xhZCNxXhGN+3TpTQSfcu5ozV/YnYcp55DS7Hpd5plVoyIpHuCwoG7+g48cjEwVmdiHH1YcoPkM/dMAZv6xi6a6CH+NF39W8ZUsdYET2TRWweLWDT+QL6ppdweI6e4cpS5Ef5qSK6I07M6xyP/Y7ROMacBqQ3CQdvFzy8Ty3jHdnPiy7ymodPchnz3xxwnm3jznid+OvPf7Xw6kOOkI8ggY6ouPjtWahVyuSF2NgJ4domXCeG5NcCZLI5fF9IEZKo+rVIUgThuggCwK8JFBVjFVIYhlhczMBxnLge+Yx1/6vOEUKgpBoEE4pmxoKGYcB1vSbBdtBSUIhgtaqgHpjQLgLi+74fC2osSC1zsFAoIJ/Po1qtNrXzXy2zoKbrJFjASqWyobZbClIGqYUEHMtolG57XfgEwRpB51eARMZBMr8MywvgroQoU4zB9/VQqYro7VYFS3aALzmBj7KPrC5g0rB1FzDIarTnqhMQwhYIoJD1VgRUbc2UZVmGnE7Dsh38SP9Ejt6TF9007fr01y503YYthyKiPdQ0DbZtQ1XVaMk9z6OVqDa9V6s3/EeQVyWbzSKTySCdlpFMpkjYaVoPnlO7U/4DtfA2TzRPT9wAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"구글 가이드\"\n        title=\"구글 가이드\"\n        src=\"/static/194acd0d320e974a099eccbb85fa554d/fcda8/google-pay-selected-guide.png\"\n        srcset=\"/static/194acd0d320e974a099eccbb85fa554d/12f09/google-pay-selected-guide.png 148w,\n/static/194acd0d320e974a099eccbb85fa554d/e4a3f/google-pay-selected-guide.png 295w,\n/static/194acd0d320e974a099eccbb85fa554d/fcda8/google-pay-selected-guide.png 590w,\n/static/194acd0d320e974a099eccbb85fa554d/4d4a2/google-pay-selected-guide.png 606w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span>{: width=“50%“}</p>\n<p>가이드를 참조하시면서 함수와 설명을 잘 읽어봅니다.\n버튼이 나타나기 위해선 아래와 같이 div로 버튼 영역을 잡아주고\n아래 스크립트는 구글페이를 사용하기 위해서 필요한 외부함수입니다. 저희쪽에서 가지고 있을 js파일이 아닙니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>container<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>script</span>\n  <span class=\"token attr-name\">async</span>\n  <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>https://pay.google.com/gp/p/js/pay.js<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token attr-name\">onload</span><span class=\"token attr-value\"><span class=\"token punctuation attr-equals\">=</span><span class=\"token punctuation\">\"</span>onGooglePayLoaded()<span class=\"token punctuation\">\"</span></span>\n<span class=\"token punctuation\">></span></span><span class=\"token script\"></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>script</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>아래는 우리쪽에서 파일로 만들어야 할 js입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">/**\n * Define the version of the Google Pay API referenced when creating your\n * configuration\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#PaymentDataRequest|apiVersion in PaymentDataRequest}\n */</span>\n<span class=\"token keyword\">const</span> baseRequest <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  apiVersion<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  apiVersionMinor<span class=\"token operator\">:</span> <span class=\"token number\">0</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Card networks supported by your site and your gateway\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n * @todo confirm card networks supported by your site and gateway\n */</span>\n<span class=\"token keyword\">const</span> allowedCardNetworks <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token string\">\"AMEX\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"DISCOVER\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"INTERAC\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"JCB\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"MASTERCARD\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">\"VISA\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">/**\n * Card authentication methods supported by your site and your gateway\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n * @todo confirm your processor supports Android device tokens for your\n * supported card networks\n */</span>\n<span class=\"token keyword\">const</span> allowedCardAuthMethods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"PAN_ONLY\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"CRYPTOGRAM_3DS\"</span><span class=\"token punctuation\">]</span>\n\n<span class=\"token comment\">/**\n * Identify your gateway and your site's gateway merchant identifier\n *\n * The Google Pay API response will return an encrypted payment method capable\n * of being charged by a supported gateway after payer authorization\n *\n * @todo check with your gateway on the parameters to pass\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#gateway|PaymentMethodTokenizationSpecification}\n */</span>\n<span class=\"token keyword\">const</span> tokenizationSpecification <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token operator\">:</span> <span class=\"token string\">\"PAYMENT_GATEWAY\"</span><span class=\"token punctuation\">,</span>\n  parameters<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    gateway<span class=\"token operator\">:</span> <span class=\"token string\">\"example\"</span><span class=\"token punctuation\">,</span>\n    gatewayMerchantId<span class=\"token operator\">:</span> <span class=\"token string\">\"exampleGatewayMerchantId\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Describe your site's support for the CARD payment method and its required\n * fields\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n */</span>\n<span class=\"token keyword\">const</span> baseCardPaymentMethod <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  type<span class=\"token operator\">:</span> <span class=\"token string\">\"CARD\"</span><span class=\"token punctuation\">,</span>\n  parameters<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    allowedAuthMethods<span class=\"token operator\">:</span> allowedCardAuthMethods<span class=\"token punctuation\">,</span>\n    allowedCardNetworks<span class=\"token operator\">:</span> allowedCardNetworks<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Describe your site's support for the CARD payment method including optional\n * fields\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#CardParameters|CardParameters}\n */</span>\n<span class=\"token keyword\">const</span> cardPaymentMethod <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> baseCardPaymentMethod<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  tokenizationSpecification<span class=\"token operator\">:</span> tokenizationSpecification<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\">/**\n * An initialized google.payments.api.PaymentsClient object or null if not yet set\n *\n * @see {@link getGooglePaymentsClient}\n */</span>\n<span class=\"token keyword\">let</span> paymentsClient <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span>\n\n<span class=\"token comment\">/**\n * Configure your site's support for payment methods supported by the Google Pay\n * API.\n *\n * Each member of allowedPaymentMethods should contain only the required fields,\n * allowing reuse of this base request when determining a viewer's ability\n * to pay and later requesting a supported payment method\n *\n * @returns {object} Google Pay API version, payment methods supported by the site\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getGoogleIsReadyToPayRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> baseRequest<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    allowedPaymentMethods<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>baseCardPaymentMethod<span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Configure support for the Google Pay API\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#PaymentDataRequest|PaymentDataRequest}\n * @returns {object} PaymentDataRequest fields\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getGooglePaymentDataRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paymentDataRequest <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">assign</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> baseRequest<span class=\"token punctuation\">)</span>\n  paymentDataRequest<span class=\"token punctuation\">.</span>allowedPaymentMethods <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>cardPaymentMethod<span class=\"token punctuation\">]</span>\n  paymentDataRequest<span class=\"token punctuation\">.</span>transactionInfo <span class=\"token operator\">=</span> <span class=\"token function\">getGoogleTransactionInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  paymentDataRequest<span class=\"token punctuation\">.</span>merchantInfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// @todo a merchant ID is available for a production environment after approval by Google</span>\n    <span class=\"token comment\">// See {@link https://developers.google.com/pay/api/web/guides/test-and-deploy/integration-checklist|Integration checklist}</span>\n    <span class=\"token comment\">// merchantId: '01234567890123456789',</span>\n    merchantName<span class=\"token operator\">:</span> <span class=\"token string\">\"Example Merchant\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> paymentDataRequest\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Return an active PaymentsClient or initialize\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/client#PaymentsClient|PaymentsClient constructor}\n * @returns {google.payments.api.PaymentsClient} Google Pay API client\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getGooglePaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>paymentsClient <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    paymentsClient <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">google<span class=\"token punctuation\">.</span>payments<span class=\"token punctuation\">.</span>api<span class=\"token punctuation\">.</span>PaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      environment<span class=\"token operator\">:</span> <span class=\"token string\">\"TEST\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> paymentsClient\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Initialize Google PaymentsClient after Google-hosted JavaScript has loaded\n *\n * Display a Google Pay payment button after confirmation of the viewer's\n * ability to pay.\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">onGooglePayLoaded</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paymentsClient <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  paymentsClient\n    <span class=\"token punctuation\">.</span><span class=\"token function\">isReadyToPay</span><span class=\"token punctuation\">(</span><span class=\"token function\">getGoogleIsReadyToPayRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">response</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>response<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">addGooglePayButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n        <span class=\"token comment\">// @todo prefetch payment data to improve performance after confirming site functionality</span>\n        <span class=\"token comment\">// prefetchGooglePaymentData();</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// show error in developer console for debugging</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Add a Google Pay purchase button alongside an existing checkout button\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#ButtonOptions|Button options}\n * @see {@link https://developers.google.com/pay/api/web/guides/brand-guidelines|Google Pay brand guidelines}\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">addGooglePayButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paymentsClient <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> paymentsClient<span class=\"token punctuation\">.</span><span class=\"token function\">createButton</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    onClick<span class=\"token operator\">:</span> onGooglePaymentButtonClicked<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"container\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Provide Google Pay API with a payment amount, currency, and amount status\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/request-objects#TransactionInfo|TransactionInfo}\n * @returns {object} transaction info, suitable for use as transactionInfo property of PaymentDataRequest\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">getGoogleTransactionInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    countryCode<span class=\"token operator\">:</span> <span class=\"token string\">\"US\"</span><span class=\"token punctuation\">,</span>\n    currencyCode<span class=\"token operator\">:</span> <span class=\"token string\">\"USD\"</span><span class=\"token punctuation\">,</span>\n    totalPriceStatus<span class=\"token operator\">:</span> <span class=\"token string\">\"FINAL\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// set to cart total</span>\n    totalPrice<span class=\"token operator\">:</span> <span class=\"token string\">\"1.00\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Prefetch payment data to improve performance\n *\n * @see {@link https://developers.google.com/pay/api/web/reference/client#prefetchPaymentData|prefetchPaymentData()}\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">prefetchGooglePaymentData</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paymentDataRequest <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentDataRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// transactionInfo must be set but does not affect cache</span>\n  paymentDataRequest<span class=\"token punctuation\">.</span>transactionInfo <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    totalPriceStatus<span class=\"token operator\">:</span> <span class=\"token string\">\"NOT_CURRENTLY_KNOWN\"</span><span class=\"token punctuation\">,</span>\n    currencyCode<span class=\"token operator\">:</span> <span class=\"token string\">\"USD\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> paymentsClient <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  paymentsClient<span class=\"token punctuation\">.</span><span class=\"token function\">prefetchPaymentData</span><span class=\"token punctuation\">(</span>paymentDataRequest<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Show Google Pay payment sheet when Google Pay payment button is clicked\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">onGooglePaymentButtonClicked</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> paymentDataRequest <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentDataRequest</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  paymentDataRequest<span class=\"token punctuation\">.</span>transactionInfo <span class=\"token operator\">=</span> <span class=\"token function\">getGoogleTransactionInfo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> paymentsClient <span class=\"token operator\">=</span> <span class=\"token function\">getGooglePaymentsClient</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  paymentsClient\n    <span class=\"token punctuation\">.</span><span class=\"token function\">loadPaymentData</span><span class=\"token punctuation\">(</span>paymentDataRequest<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">paymentData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// handle the response</span>\n      <span class=\"token function\">processPayment</span><span class=\"token punctuation\">(</span>paymentData<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">catch</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">err</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// show error in developer console for debugging</span>\n      console<span class=\"token punctuation\">.</span><span class=\"token function\">error</span><span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token comment\">/**\n * Process payment data returned by the Google Pay API\n *\n * @param {object} paymentData response from Google Pay API after user approves payment\n * @see {@link https://developers.google.com/pay/api/web/reference/response-objects#PaymentData|PaymentData object reference}\n */</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">processPayment</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">paymentData</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// show returned data in developer console for debugging</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>paymentData<span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// @todo pass payment token to your gateway to process payment</span>\n  paymentToken <span class=\"token operator\">=</span> paymentData<span class=\"token punctuation\">.</span>paymentMethodData<span class=\"token punctuation\">.</span>tokenizationData<span class=\"token punctuation\">.</span>token\n<span class=\"token punctuation\">}</span></code></pre></div>","tableOfContents":"","frontmatter":{"title":"Google Pay API 가이드","date":"March 13, 2020","description":null,"image":null}},"allMarkdownRemark":{"edges":[{"node":{"fields":{"slug":"/others/2021/ways-after-quiting/"},"frontmatter":{"title":"직장을 그만두고 할 만한 개발 교육 소개","date":"2021-02-08"}}},{"node":{"fields":{"slug":"/others/2021/making-windows10-usb-on-mac/"},"frontmatter":{"title":"MacOS에서 Windows10 포맷 USB 만들기","date":"2021-01-28"}}},{"node":{"fields":{"slug":"/others/2020/why-index-start-zero/"},"frontmatter":{"title":"왜 배열은 인덱스가 0부터 시작할까?","date":"2020-12-22"}}},{"node":{"fields":{"slug":"/others/2020/to-begineer/"},"frontmatter":{"title":"개발자에게 도움이 될만한 사이트 소개합니다","date":"2020-12-09"}}},{"node":{"fields":{"slug":"/others/2020/social-network-account-info/"},"frontmatter":{"title":"간편로그인 계정 검수 가이드","date":"2020-08-05"}}},{"node":{"fields":{"slug":"/others/2020/windows-hyper-v/"},"frontmatter":{"title":"윈도우 Hyper V로 가상 윈도우10 설치","date":"2020-06-20"}}},{"node":{"fields":{"slug":"/others/2020/windows-chocolatey/"},"frontmatter":{"title":"윈도우 Chocolatey 설치","date":"2020-06-18"}}},{"node":{"fields":{"slug":"/others/2020/change-language/"},"frontmatter":{"title":"크롬에서 언어 변환하기","date":"2020-05-13"}}},{"node":{"fields":{"slug":"/others/2020/install-jekyll-mac/"},"frontmatter":{"title":"맥에서 Jekyll 설치하기","date":"2020-05-12"}}},{"node":{"fields":{"slug":"/others/2020/mac-external-monitor-setting/"},"frontmatter":{"title":"맥북프로 듀얼 모니터 마우스 끊겨서 움직일 때","date":"2020-03-24"}}},{"node":{"fields":{"slug":"/others/2020/naver-pay-api-guide/"},"frontmatter":{"title":"Naver Pay API 가이드","date":"2020-03-13"}}},{"node":{"fields":{"slug":"/others/2020/pay-api/"},"frontmatter":{"title":"PAY API 링크","date":"2020-03-12"}}},{"node":{"fields":{"slug":"/others/2020/securities-open-platform/"},"frontmatter":{"title":"증권사 API 정리","date":"2020-03-11"}}},{"node":{"fields":{"slug":"/others/2019/im-tired-of-vscode/"},"frontmatter":{"title":"vscode preview를 피하는 법","date":"2019-12-27"}}},{"node":{"fields":{"slug":"/others/2019/git-account/"},"frontmatter":{"title":"저장소마다 user 설정","date":"2019-09-18"}}}]}},"pageContext":{"slug":"/others/2020/google-pay-api-guide/","tag":"others","previous":{"fields":{"slug":"/others/2020/naver-pay-api-guide/"},"frontmatter":{"tags":["others","naver","api"]}},"next":{"fields":{"slug":"/backend/2020/nodejs-express-guid/"},"frontmatter":{"tags":["backend","javascript"]}}}},"staticQueryHashes":["1146911855","1973561601","3826269039"]}