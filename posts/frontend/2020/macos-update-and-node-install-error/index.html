<!DOCTYPE html><html lang="ko"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width"/><meta name="next-head-count" content="2"/><link rel="preload" href="/_next/static/css/cf50bc513bb312fb.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf50bc513bb312fb.css" data-n-g=""/><link rel="preload" href="/_next/static/css/cf392dd387379326.css" as="style"/><link rel="stylesheet" href="/_next/static/css/cf392dd387379326.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-8fa1640cc84ba8fe.js" defer=""></script><script src="/_next/static/chunks/framework-7751730b10fa0f74.js" defer=""></script><script src="/_next/static/chunks/main-417c86299e0e3115.js" defer=""></script><script src="/_next/static/chunks/pages/_app-3f357b7937ff6115.js" defer=""></script><script src="/_next/static/chunks/358-1fc680902af364db.js" defer=""></script><script src="/_next/static/chunks/675-717e3cc8fb67a947.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5B...slug%5D-f8930ebaf4ef3376.js" defer=""></script><script src="/_next/static/x4I7aGmlNNdMMn8qGuRvp/_buildManifest.js" defer=""></script><script src="/_next/static/x4I7aGmlNNdMMn8qGuRvp/_ssgManifest.js" defer=""></script></head><body><div id="__next"><nav class="absolute w-full pt-3"><div class="container mx-auto flex flex-wrap"><a class="w-2/6 text-lg font-bold" href="/">🌎 Sunhwang&#x27;s blog</a><ul class="flex grow justify-end space-x-10"><li><a class="hover:underline hover:underline-offset-8 " href="/tags">Tags</a></li><li><a class="hover:underline hover:underline-offset-8 " href="/about">About me</a></li></ul></div></nav><main><div class="container mx-auto pt-10"><article class="mb-32"><div class="mx-auto flex max-w-6xl justify-start align-middle"><h1 class="mt-20 mb-6 text-5xl font-bold leading-tight tracking-tighter md:text-left md:text-7xl md:leading-none lg:text-4xl">mac OS Update와 Node Updagrade 후 발생한 에러</h1></div><div class="mb-8 sm:mx-0 md:mb-16"><div class="sm:mx-0"><span style="box-sizing:border-box;display:block;overflow:hidden;width:initial;height:initial;background:none;opacity:1;border:0;margin:0;padding:0"><img alt="Cover Image for mac OS Update와 Node Updagrade 후 발생한 에러" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" decoding="async" data-nimg="intrinsic" class="shadow-sm" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%"/><noscript><img alt="Cover Image for mac OS Update와 Node Updagrade 후 발생한 에러" src="" decoding="async" data-nimg="intrinsic" style="position:absolute;top:0;left:0;bottom:0;right:0;box-sizing:border-box;padding:0;border:none;margin:auto;display:block;width:0;height:0;min-width:100%;max-width:100%;min-height:100%;max-height:100%" class="shadow-sm" loading="lazy"/></noscript></span></div></div><div class="mx-auto flex max-w-5xl justify-end"><div class="mb-4 text-sm text-gray-600 underline underline-offset-8"><time dateTime="2020-11-09">2020-11-09</time></div></div><div class="mx-auto max-w-6xl"><article class="markdown-styles_markdown__h_8de"><!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Contents</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
<p>macOS Catalina 10.15.7로 업데이트 후에 오랜만에 brew upgrade를 실행 해 node가 15버전이 되었다.(아..안돼..!)</p>
<p>그리고 gatsby develop로 블로그 프로젝트를 실행시키는데 여러 에러가 나왔다.</p>
<p>그래서 node 버전을 올림겸 package.json파일에서 버전을 전부 최신으로 올렸다.</p>
<p>sharp 관련해서 에러가 났는데 .node_module과 .cache파일을 삭제 후에 npm i 명령어로 실행하면 아래와 관련한 에러가 나왔다.</p>
<pre><code class="language-bash">@sjhwang-MacBookPro ➜ get6.github.io git:(source) ✗ npm i
npm ERR! code 1
npm ERR! path /Users/sjhwang/GitHub/get6.github.io/node_modules/sharp
npm ERR! command failed
npm ERR! command sh -c node-gyp rebuild
npm ERR! CC(target) Release/obj.target/nothing/../node-addon-api/nothing.o
npm ERR!   LIBTOOL-STATIC Release/nothing.a
npm ERR!   TOUCH Release/obj.target/libvips-cpp.stamp
npm ERR!   CXX(target) Release/obj.target/sharp/src/common.o
npm ERR! gyp info it worked if it ends with ok
npm ERR! gyp info using node-gyp@7.1.2
npm ERR! gyp info using node@15.1.0 | darwin | x64
npm ERR! gyp info find Python using Python version 3.9.0 found at "/usr/local/opt/python@3.9/bin/python3.9"
npm ERR! gyp info spawn /usr/local/opt/python@3.9/bin/python3.9
npm ERR! gyp info spawn args [
npm ERR! gyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',
npm ERR! gyp info spawn args   'binding.gyp',
npm ERR! gyp info spawn args   '-f',
npm ERR! gyp info spawn args   'make',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   '/Users/sjhwang/GitHub/get6.github.io/node_modules/sharp/build/config.gypi',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',
npm ERR! gyp info spawn args   '-I',
npm ERR! gyp info spawn args   '/Users/sjhwang/Library/Caches/node-gyp/15.1.0/include/node/common.gypi',
npm ERR! gyp info spawn args   '-Dlibrary=shared_library',
npm ERR! gyp info spawn args   '-Dvisibility=default',
npm ERR! gyp info spawn args   '-Dnode_root_dir=/Users/sjhwang/Library/Caches/node-gyp/15.1.0',
npm ERR! gyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',
npm ERR! gyp info spawn args   '-Dnode_lib_file=/Users/sjhwang/Library/Caches/node-gyp/15.1.0/&#x3C;(target_arch)/node.lib',
npm ERR! gyp info spawn args   '-Dmodule_root_dir=/Users/sjhwang/GitHub/get6.github.io/node_modules/sharp',
npm ERR! gyp info spawn args   '-Dnode_engine=v8',
npm ERR! gyp info spawn args   '--depth=.',
npm ERR! gyp info spawn args   '--no-parallel',
npm ERR! gyp info spawn args   '--generator-output',
npm ERR! gyp info spawn args   'build',
npm ERR! gyp info spawn args   '-Goutput_dir=.'
npm ERR! gyp info spawn args ]
npm ERR! gyp info spawn make
npm ERR! gyp info spawn args [ 'BUILDTYPE=Release', '-C', 'build' ]
npm ERR! warning: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: archive library: Release/nothing.a the table of contents is empty (no object file members in the library define global symbols)
npm ERR! ../src/common.cc:23:10: fatal error: 'vips/vips8' file not found
npm ERR! #include &#x3C;vips/vips8>
npm ERR!          ^~~~~~~~~~~~
npm ERR! 1 error generated.
npm ERR! make: *** [Release/obj.target/sharp/src/common.o] Error 1
npm ERR! gyp ERR! build error
npm ERR! gyp ERR! stack Error: `make` failed with exit code: 2
npm ERR! gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:194:23)
npm ERR! gyp ERR! stack     at ChildProcess.emit (node:events:327:20)
npm ERR! gyp ERR! stack     at Process.ChildProcess._handle.onexit (node:internal/child_process:277:12)
npm ERR! gyp ERR! System Darwin 19.6.0
npm ERR! gyp ERR! command "/usr/local/Cellar/node/15.1.0/bin/node" "/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js" "rebuild"
npm ERR! gyp ERR! cwd /Users/sjhwang/GitHub/get6.github.io/node_modules/sharp
npm ERR! gyp ERR! node -v v15.1.0
npm ERR! gyp ERR! node-gyp -v v7.1.2
npm ERR! gyp ERR! not ok

npm ERR! A complete log of this run can be found in:
npm ERR!     /Users/sjhwang/.npm/_logs/2020-11-09T01_17_55_584Z-debug.log
</code></pre>
<p>구글링 하다보니 이렇게 하면 됬다.</p>
<p>기존에는 설치한 적 없던 vips를 설치해야 했다. 설치는 꽤 걸린다.</p>
<blockquote>
<p><strong>그러나 node 15버전인 경우에는 이럴 필요 없이 안정화 버전으로 내려야 한다. (아래 참조)</strong></p>
</blockquote>
<pre><code class="language-bash">rm -rf /Users/{username}/.npm/_libvips
brew install vips // If this command throws some error about could not download cfitsio, just ignore.
rm -rf node_modules
npm i
</code></pre>
<p>설치 후 실행하니 또 다른 에러가 나왔다.</p>
<pre><code class="language-bash">ERROR

Processing /Users/sjhwang/GitHub/get6.github.io/content/blog/frontend/2020/blog-with-gatsbyjs/images/assets_folder.png failed

Original error:
Command failed with ENOENT: /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant - --strip --quality 50-75
spawn /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant ENOENT




  WorkerError: Processing /Users/sjhwang/GitHub/get6.github.io/content/blog/frontend/2020/blog-with-gatsbyjs/images/assets_folder.png failed
  Original error:
  Command failed with ENOENT: /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant - --strip --quality 50-75
  spawn /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant ENOENT
  
  - jobs-manager.ts:318 enqueueJob
    [get6.github.io]/[gatsby]/src/utils/jobs-manager.ts:318:21
  
  - task_queues:93 processTicksAndRejections
    node:internal/process/task_queues:93:ㅜ5
  

not finished Generating image thumbnails - 0.367s
not finished run page queries - 0.329s
</code></pre>
<p>node_modules/pngquant-bin/vendor/pngquant 파일이 없었고 결국 node 15 최신 버전에서 안정화 버전인 14.15.0으로 돌아가기로 했다.</p>
<p>자꾸 알 수 없는 에러가 났던 문제는 node version이었다.</p>
<p>그 다음부턴 문제 없이 동작한다~</p>
</body>
</html>
</article></div></article></div></main></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"title":"mac OS Update와 Node Updagrade 후 발생한 에러","date":"2020-11-09","slug":"frontend/2020/macos-update-and-node-install-error/index","content":"\u003c!doctype html\u003e\n\u003chtml lang=\"en\"\u003e\n\u003chead\u003e\n\u003cmeta charset=\"utf-8\"\u003e\n\u003ctitle\u003eContents\u003c/title\u003e\n\u003cmeta name=\"viewport\" content=\"width=device-width, initial-scale=1\"\u003e\n\u003c/head\u003e\n\u003cbody\u003e\n\u003cp\u003emacOS Catalina 10.15.7로 업데이트 후에 오랜만에 brew upgrade를 실행 해 node가 15버전이 되었다.(아..안돼..!)\u003c/p\u003e\n\u003cp\u003e그리고 gatsby develop로 블로그 프로젝트를 실행시키는데 여러 에러가 나왔다.\u003c/p\u003e\n\u003cp\u003e그래서 node 버전을 올림겸 package.json파일에서 버전을 전부 최신으로 올렸다.\u003c/p\u003e\n\u003cp\u003esharp 관련해서 에러가 났는데 .node_module과 .cache파일을 삭제 후에 npm i 명령어로 실행하면 아래와 관련한 에러가 나왔다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003e@sjhwang-MacBookPro ➜ get6.github.io git:(source) ✗ npm i\nnpm ERR! code 1\nnpm ERR! path /Users/sjhwang/GitHub/get6.github.io/node_modules/sharp\nnpm ERR! command failed\nnpm ERR! command sh -c node-gyp rebuild\nnpm ERR! CC(target) Release/obj.target/nothing/../node-addon-api/nothing.o\nnpm ERR!   LIBTOOL-STATIC Release/nothing.a\nnpm ERR!   TOUCH Release/obj.target/libvips-cpp.stamp\nnpm ERR!   CXX(target) Release/obj.target/sharp/src/common.o\nnpm ERR! gyp info it worked if it ends with ok\nnpm ERR! gyp info using node-gyp@7.1.2\nnpm ERR! gyp info using node@15.1.0 | darwin | x64\nnpm ERR! gyp info find Python using Python version 3.9.0 found at \"/usr/local/opt/python@3.9/bin/python3.9\"\nnpm ERR! gyp info spawn /usr/local/opt/python@3.9/bin/python3.9\nnpm ERR! gyp info spawn args [\nnpm ERR! gyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/gyp/gyp_main.py',\nnpm ERR! gyp info spawn args   'binding.gyp',\nnpm ERR! gyp info spawn args   '-f',\nnpm ERR! gyp info spawn args   'make',\nnpm ERR! gyp info spawn args   '-I',\nnpm ERR! gyp info spawn args   '/Users/sjhwang/GitHub/get6.github.io/node_modules/sharp/build/config.gypi',\nnpm ERR! gyp info spawn args   '-I',\nnpm ERR! gyp info spawn args   '/usr/local/lib/node_modules/npm/node_modules/node-gyp/addon.gypi',\nnpm ERR! gyp info spawn args   '-I',\nnpm ERR! gyp info spawn args   '/Users/sjhwang/Library/Caches/node-gyp/15.1.0/include/node/common.gypi',\nnpm ERR! gyp info spawn args   '-Dlibrary=shared_library',\nnpm ERR! gyp info spawn args   '-Dvisibility=default',\nnpm ERR! gyp info spawn args   '-Dnode_root_dir=/Users/sjhwang/Library/Caches/node-gyp/15.1.0',\nnpm ERR! gyp info spawn args   '-Dnode_gyp_dir=/usr/local/lib/node_modules/npm/node_modules/node-gyp',\nnpm ERR! gyp info spawn args   '-Dnode_lib_file=/Users/sjhwang/Library/Caches/node-gyp/15.1.0/\u0026#x3C;(target_arch)/node.lib',\nnpm ERR! gyp info spawn args   '-Dmodule_root_dir=/Users/sjhwang/GitHub/get6.github.io/node_modules/sharp',\nnpm ERR! gyp info spawn args   '-Dnode_engine=v8',\nnpm ERR! gyp info spawn args   '--depth=.',\nnpm ERR! gyp info spawn args   '--no-parallel',\nnpm ERR! gyp info spawn args   '--generator-output',\nnpm ERR! gyp info spawn args   'build',\nnpm ERR! gyp info spawn args   '-Goutput_dir=.'\nnpm ERR! gyp info spawn args ]\nnpm ERR! gyp info spawn make\nnpm ERR! gyp info spawn args [ 'BUILDTYPE=Release', '-C', 'build' ]\nnpm ERR! warning: /Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/libtool: archive library: Release/nothing.a the table of contents is empty (no object file members in the library define global symbols)\nnpm ERR! ../src/common.cc:23:10: fatal error: 'vips/vips8' file not found\nnpm ERR! #include \u0026#x3C;vips/vips8\u003e\nnpm ERR!          ^~~~~~~~~~~~\nnpm ERR! 1 error generated.\nnpm ERR! make: *** [Release/obj.target/sharp/src/common.o] Error 1\nnpm ERR! gyp ERR! build error\nnpm ERR! gyp ERR! stack Error: `make` failed with exit code: 2\nnpm ERR! gyp ERR! stack     at ChildProcess.onExit (/usr/local/lib/node_modules/npm/node_modules/node-gyp/lib/build.js:194:23)\nnpm ERR! gyp ERR! stack     at ChildProcess.emit (node:events:327:20)\nnpm ERR! gyp ERR! stack     at Process.ChildProcess._handle.onexit (node:internal/child_process:277:12)\nnpm ERR! gyp ERR! System Darwin 19.6.0\nnpm ERR! gyp ERR! command \"/usr/local/Cellar/node/15.1.0/bin/node\" \"/usr/local/lib/node_modules/npm/node_modules/node-gyp/bin/node-gyp.js\" \"rebuild\"\nnpm ERR! gyp ERR! cwd /Users/sjhwang/GitHub/get6.github.io/node_modules/sharp\nnpm ERR! gyp ERR! node -v v15.1.0\nnpm ERR! gyp ERR! node-gyp -v v7.1.2\nnpm ERR! gyp ERR! not ok\n\nnpm ERR! A complete log of this run can be found in:\nnpm ERR!     /Users/sjhwang/.npm/_logs/2020-11-09T01_17_55_584Z-debug.log\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e구글링 하다보니 이렇게 하면 됬다.\u003c/p\u003e\n\u003cp\u003e기존에는 설치한 적 없던 vips를 설치해야 했다. 설치는 꽤 걸린다.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003e\u003cstrong\u003e그러나 node 15버전인 경우에는 이럴 필요 없이 안정화 버전으로 내려야 한다. (아래 참조)\u003c/strong\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003erm -rf /Users/{username}/.npm/_libvips\nbrew install vips // If this command throws some error about could not download cfitsio, just ignore.\nrm -rf node_modules\nnpm i\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e설치 후 실행하니 또 다른 에러가 나왔다.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"language-bash\"\u003eERROR\n\nProcessing /Users/sjhwang/GitHub/get6.github.io/content/blog/frontend/2020/blog-with-gatsbyjs/images/assets_folder.png failed\n\nOriginal error:\nCommand failed with ENOENT: /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant - --strip --quality 50-75\nspawn /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant ENOENT\n\n\n\n\n  WorkerError: Processing /Users/sjhwang/GitHub/get6.github.io/content/blog/frontend/2020/blog-with-gatsbyjs/images/assets_folder.png failed\n  Original error:\n  Command failed with ENOENT: /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant - --strip --quality 50-75\n  spawn /Users/sjhwang/GitHub/get6.github.io/node_modules/pngquant-bin/vendor/pngquant ENOENT\n  \n  - jobs-manager.ts:318 enqueueJob\n    [get6.github.io]/[gatsby]/src/utils/jobs-manager.ts:318:21\n  \n  - task_queues:93 processTicksAndRejections\n    node:internal/process/task_queues:93:ㅜ5\n  \n\nnot finished Generating image thumbnails - 0.367s\nnot finished run page queries - 0.329s\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003enode_modules/pngquant-bin/vendor/pngquant 파일이 없었고 결국 node 15 최신 버전에서 안정화 버전인 14.15.0으로 돌아가기로 했다.\u003c/p\u003e\n\u003cp\u003e자꾸 알 수 없는 에러가 났던 문제는 node version이었다.\u003c/p\u003e\n\u003cp\u003e그 다음부턴 문제 없이 동작한다~\u003c/p\u003e\n\u003c/body\u003e\n\u003c/html\u003e\n"}},"__N_SSG":true},"page":"/posts/[...slug]","query":{"slug":["frontend","2020","macos-update-and-node-install-error","index"]},"buildId":"x4I7aGmlNNdMMn8qGuRvp","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>